<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Click Click Gamedev</title>
</head>
<body>

<h1>Welcome to Click Click Gamedev</h1>
<h3>make a game by clicking on the game-making button:</h3>

<button onclick="makeGame();">Make a game now</button><br>
<button onclick="hireDev();">Hire a dev</button><br>
A dev costs 12.5 money per second


<br><br>
<span style="background: #aaaaff;" id="status"></span><br>
<br>

<div id="statistics">

</div>

</body>

<script>
    let gameState = window.localStorage;

    // if values already exist, keep them. Otherwise, initialize with 0
    gameState.games_made |= 0;
    gameState.devs_hired |= 0;
    gameState.money |= 0;
    gameState.time_played |= 0;
    gameState.running_costs |= 0;

    var gamemade = false;

    // get containers for displaying info
    let statusContainer = document.getElementById('status');
    let statisticsContainer = document.getElementById('statistics');

    init();

    // initialize the game
    function init() {
        // PLACEHOLDER other things we need to setup when the site is visited, before the game loop

        // start game loop
        gameLoopUpdate();
    }

    // actual game loop.
    // update money available, time played, ...
    function gameLoopUpdate() {
        setTimeout(gameLoopUpdate, 1000);
        gameState.time_played++;
        gameState.money++;
        gameState.money -= gameState.running_costs;
        updateStatistics()
    }

    // process making a game. Subtract money, etc..
    // TODO make the game create additional income
    // TODO make the game take time to get done. It'll get done faster with few more devs
    function makeGame() {
        if (gameState.money < 2) {
            updateStatus("not enough money");
        } else {
            gameState.money -= 2;
            gamemade = true;
            gameState.games_made++;
            updateStatus("Game made");
            updateStatistics();
        }
    }

    // TODO influence time for game to get done
    function hireDev() {
        gameState.devs_hired++;
        addRunningCosts(0.125);
        updateStatus("Dev hired");
        updateStatistics();
    }

    function updateStatus(message) {
        statusContainer.innerHTML = message;
        setTimeout(clearUpdate, 3000); // clear status message after 3 seconds
    }

    function clearUpdate() {
        statusContainer.innerHTML = "";
    }

    function updateStatistics(){
        statisticsContainer.innerHTML = "money: " + gameState.money * 100 + "<br>";
        statisticsContainer.innerHTML += "games made: " + gameState.games_made + "<br>";
        statisticsContainer.innerHTML += "devs hired: " + gameState.devs_hired + "<br>";
        statisticsContainer.innerHTML += "time played in seconds: " + gameState.time_played + "<br>";
        statisticsContainer.innerHTML += "running costs: " + gameState.running_costs + "<br>";
    }

    // adds some cost to be subtracted each second, e.g. devs
    function addRunningCosts(amount) {
        gameState.running_costs += amount;
    }

</script>

</html>